#!/bin/bash

# –ü—ñ–¥–≥–æ—Ç–æ–≤–∫–∞ –¥–æ –¥–µ–ø–ª–æ—é
echo "üöÄ –ü–æ—á–∏–Ω–∞—é –ø—ñ–¥–≥–æ—Ç–æ–≤–∫—É –¥–æ –¥–µ–ø–ª–æ—é..."

# –í–∏–¥–∞–ª—è—î–º–æ –∫–µ—à-—Ñ–∞–π–ª–∏
echo "üßπ –í–∏–¥–∞–ª—è—é –∫–µ—à —Ç–∞ –Ω–µ–≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞–Ω—ñ —Ñ–∞–π–ª–∏..."
find . -name '.DS_Store' -delete
find . -name '__MACOSX' -exec rm -rf {} +
find . -name '*.pyc' -delete
find . -name '__pycache__' -exec rm -rf {} +

# –ü–µ—Ä–µ–≤—ñ—Ä—è—î–º–æ –Ω–∞—è–≤–Ω—ñ—Å—Ç—å –≤–∞–∂–ª–∏–≤–∏—Ö —Ñ–∞–π–ª—ñ–≤
echo "üîç –ü–µ—Ä–µ–≤—ñ—Ä—è—é –Ω–∞—è–≤–Ω—ñ—Å—Ç—å –∫—Ä–∏—Ç–∏—á–Ω–∏—Ö —Ñ–∞–π–ª—ñ–≤..."
if [ ! -f "passenger_wsgi.py" ]; then
    echo "‚ùå passenger_wsgi.py –≤—ñ–¥—Å—É—Ç–Ω—ñ–π!"
    exit 1
fi

if [ ! -f ".htaccess" ]; then
    echo "‚ùå .htaccess –≤—ñ–¥—Å—É—Ç–Ω—ñ–π!"
    exit 1
fi

if [ ! -f "env_template.txt" ]; then
    echo "‚ùå env_template.txt –≤—ñ–¥—Å—É—Ç–Ω—ñ–π!"
    exit 1
fi

# –ó–±–∏—Ä–∞—î–º–æ —Å—Ç–∞—Ç–∏—á–Ω—ñ —Ñ–∞–π–ª–∏
echo "üì¶ –ó–±–∏—Ä–∞—é —Å—Ç–∞—Ç–∏—á–Ω—ñ —Ñ–∞–π–ª–∏..."
if [ -d "venv" ]; then
    source venv/bin/activate
    python manage.py collectstatic --noinput
    deactivate
else
    echo "‚ö†Ô∏è –í—ñ—Ä—Ç—É–∞–ª—å–Ω–µ —Å–µ—Ä–µ–¥–æ–≤–∏—â–µ 'venv' –Ω–µ –∑–Ω–∞–π–¥–µ–Ω–æ! –ü—Ä–æ–ø—É—Å–∫–∞—é –∑–±—ñ—Ä —Å—Ç–∞—Ç–∏—á–Ω–∏—Ö —Ñ–∞–π–ª—ñ–≤."
fi

# –°—Ç–≤–æ—Ä—é—î–º–æ –∞—Ä—Ö—ñ–≤
echo "üìÅ –°—Ç–≤–æ—Ä—é—é –∞—Ä—Ö—ñ–≤ –¥–ª—è –¥–µ–ø–ª–æ—é..."
zip -r airinua_deploy.zip . -x "*.git*" "*.DS_Store" "*__pycache__*" "*.pyc" "venv/*" "*.zip" "logs/*" "staticfiles/*"

echo "‚úÖ –ü—ñ–¥–≥–æ—Ç–æ–≤–∫–∞ –¥–æ –¥–µ–ø–ª–æ—é –∑–∞–≤–µ—Ä—à–µ–Ω–∞!"
echo "üìã –ù–∞—Å—Ç—É–ø–Ω—ñ –∫—Ä–æ–∫–∏:"
echo "1. –ó–∞–≤–∞–Ω—Ç–∞–∂—Ç–µ 'airinua_deploy.zip' –Ω–∞ –≤–∞—à —Ö–æ—Å—Ç–∏–Ω–≥"
echo "2. –†–æ–∑–ø–∞–∫—É–π—Ç–µ –∞—Ä—Ö—ñ–≤ –≤ –∫–æ—Ä–µ–Ω–µ–≤—É –ø–∞–ø–∫—É —Å–∞–π—Ç—É"
echo "3. –û–Ω–æ–≤—ñ—Ç—å —à–ª—è—Ö –¥–æ Python —ñ–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ç–æ—Ä–∞ –≤ passenger_wsgi.py"
echo "4. –°—Ç–≤–æ—Ä—ñ—Ç—å —Ñ–∞–π–ª .env –Ω–∞ –æ—Å–Ω–æ–≤—ñ env_template.txt"
echo "5. –°—Ç–≤–æ—Ä—ñ—Ç—å –≤—ñ—Ä—Ç—É–∞–ª—å–Ω–µ —Å–µ—Ä–µ–¥–æ–≤–∏—â–µ —Ç–∞ –≤—Å—Ç–∞–Ω–æ–≤—ñ—Ç—å –∑–∞–ª–µ–∂–Ω–æ—Å—Ç—ñ"
echo "6. –ó–∞–ø—É—Å—Ç—ñ—Ç—å –º—ñ–≥—Ä–∞—Ü—ñ—ó —Ç–∞ –∑–±—ñ—Ä —Å—Ç–∞—Ç–∏—á–Ω–∏—Ö —Ñ–∞–π–ª—ñ–≤"
echo "7. –ù–∞–ª–∞—à—Ç—É–π—Ç–µ Python App —É cPanel"
echo "8. –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ —Ä–æ–±–æ—Ç—É —Å–∞–π—Ç—É" 